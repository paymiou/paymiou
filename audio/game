<!DOCTYPE html>
<html lang="zh">
<head>
<meta charset="UTF-8">
<title>3D æµ·åº•æ°¸çºŒæ¢éšª</title>

<style>
body {
    margin:0;
    overflow:hidden;
    font-family:sans-serif;
    background:black;
}

#ui {
    position:absolute;
    top:20px;
    left:20px;
    color:white;
    background:rgba(0,0,0,0.5);
    padding:15px;
    border-radius:10px;
}

#questionBox {
    position:absolute;
    top:50%;
    left:50%;
    transform:translate(-50%,-50%);
    background:white;
    padding:20px;
    border-radius:10px;
    display:none;
    width:300px;
}

button {
    margin-top:10px;
    padding:10px;
    width:100%;
}
</style>

</head>
<body>

<div id="ui">
ğŸŒŠ æµ·åº•æ·±åº¦: <span id="depth">0</span> m<br>
ğŸ§´ æ¸…é™¤åƒåœ¾: <span id="score">0</span>
</div>

<div id="questionBox">
<div id="questionText"></div>
<button onclick="answer(true)">æ­£ç¢º</button>
<button onclick="answer(false)">éŒ¯èª¤</button>
</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>

<script>

// ====== ThreeJS åŸºæœ¬è¨­å®š ======

const scene = new THREE.Scene()
scene.background = new THREE.Color(0x001e3c)
scene.fog = new THREE.Fog(0x001e3c, 10, 50)

const camera = new THREE.PerspectiveCamera(
75,
window.innerWidth/window.innerHeight,
0.1,
1000
)

const renderer = new THREE.WebGLRenderer()
renderer.setSize(window.innerWidth, window.innerHeight)
document.body.appendChild(renderer.domElement)

// ===== å…‰æº =====

const light = new THREE.PointLight(0x66ccff, 2, 50)
light.position.set(0,10,0)
scene.add(light)

const ambient = new THREE.AmbientLight(0x404040)
scene.add(ambient)

// ===== æµ·åº• =====

const floorGeo = new THREE.PlaneGeometry(200,200)
const floorMat = new THREE.MeshPhongMaterial({
color:0x0a2a43
})

const floor = new THREE.Mesh(floorGeo,floorMat)
floor.rotation.x = -Math.PI/2
scene.add(floor)

// ===== ç©å®¶ =====

camera.position.y = 2
camera.position.z = 5

let keys = {}

document.addEventListener("keydown",e=>{
keys[e.key]=true
})

document.addEventListener("keyup",e=>{
keys[e.key]=false
})

// ===== æ»‘é¼ è¦–è§’ =====

let mouseX = 0
let mouseY = 0

document.addEventListener("mousemove",e=>{
mouseX = (e.clientX/window.innerWidth-0.5)*2
mouseY = (e.clientY/window.innerHeight-0.5)*2
})

// ===== åƒåœ¾ =====

let trashList = []

function spawnTrash(){

const geo = new THREE.BoxGeometry(1,1,1)
const mat = new THREE.MeshPhongMaterial({
color:0xff5555
})

const trash = new THREE.Mesh(geo,mat)

trash.position.x = Math.random()*40-20
trash.position.z = Math.random()*40-20
trash.position.y = 1

scene.add(trash)
trashList.push(trash)

}

// ç”Ÿæˆ20å€‹åƒåœ¾
for(let i=0;i<20;i++){
spawnTrash()
}

// ===== é¡Œåº« =====

const questions = [
{q:"å¡‘è† éœ€è¦æ•¸ç™¾å¹´åˆ†è§£ï¼Ÿ",a:true},
{q:"å¡‘è† è¢‹å¯ä»¥è‡ªç„¶æ¶ˆå¤±ï¼Ÿ",a:false},
{q:"å¯¶ç‰¹ç“¶å¯ä»¥å›æ”¶ï¼Ÿ",a:true},
{q:"æµ·é¾œæœƒåƒå¡‘è† ï¼Ÿ",a:true},
{q:"å¡‘è† å°æµ·æ´‹ç„¡å®³ï¼Ÿ",a:false},
{q:"å¾®å¡‘è† å­˜åœ¨æµ·æ´‹ï¼Ÿ",a:true},
{q:"å¡‘è† ç‡ƒç‡’ç„¡æ¯’ï¼Ÿ",a:false},
{q:"ä¸€æ¬¡æ€§å¡‘è† å¯é‡è¤‡ç”¨ï¼Ÿ",a:true},
{q:"å¸ç®¡ä¸å¯å›æ”¶ï¼Ÿ",a:true},
{q:"å¡‘è† ä¾†è‡ªçŸ³æ²¹ï¼Ÿ",a:true}
]

let currentQuestion
let currentTrash

// ===== é»æ“Šåµæ¸¬ =====

const raycaster = new THREE.Raycaster()
const mouse = new THREE.Vector2()

window.addEventListener("click",e=>{

mouse.x = (e.clientX/window.innerWidth)*2-1
mouse.y = -(e.clientY/window.innerHeight)*2+1

raycaster.setFromCamera(mouse,camera)

const hits = raycaster.intersectObjects(trashList)

if(hits.length>0){

currentTrash = hits[0].object

askQuestion()

}

})

// ===== å•é¡Œ =====

function askQuestion(){

currentQuestion =
questions[Math.floor(Math.random()*questions.length)]

document.getElementById("questionText").innerText =
currentQuestion.q

document.getElementById("questionBox").style.display="block"

}

// ===== å›ç­” =====

function answer(choice){

if(choice==currentQuestion.a){

scene.remove(currentTrash)
trashList.splice(trashList.indexOf(currentTrash),1)

score++

document.getElementById("score").innerText=score

}

document.getElementById("questionBox").style.display="none"

}

// ===== åˆ†æ•¸ =====

let score=0

// ===== ç§»å‹• =====

function move(){

const speed=0.1

if(keys["w"]) camera.position.z-=speed
if(keys["s"]) camera.position.z+=speed
if(keys["a"]) camera.position.x-=speed
if(keys["d"]) camera.position.x+=speed

camera.rotation.y = -mouseX*0.5
camera.rotation.x = -mouseY*0.3

}

// ===== æ·±åº¦ =====

function updateDepth(){

const depth =
Math.floor(Math.abs(camera.position.z))

document.getElementById("depth").innerText=depth

}

// ===== å‹•ç•« =====

function animate(){

requestAnimationFrame(animate)

move()
updateDepth()

renderer.render(scene,camera)

}

animate()

</script>

</body>
</html>
